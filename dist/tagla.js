(function() {
  var Tagla, proto;

  Tagla = (function() {
    function Tagla($wrapper, options) {
      if (options == null) {
        options = {};
      }
      this.wrapper = $($wrapper);
      this.init(options);
      this.bind();
    }

    return Tagla;

  })();

  Tagla.NAME = 'Tagla';

  Tagla.PREFIX = 'tagla-';

  Tagla.FORM_TEMPLATE = ['<form class="photo-tags-form photo-tags-form-hide">', '     <input type="hidden" name="x">', '     <input type="hidden" name="y">', '     <label class="photo-tags-form-label">', '         <select data-placeholder="Choose tags..." type="text" name="label" class="tagla-form-input chosen-select">', '             <option>Frankie Issue #6</option>', '             <option>Frankie Wall Calendar 2015</option>', '             <option>Frankie A5 Daily Planner</option>', '         </select>', '     </label>', '     <button type="submit" class="photo-tags-form-button">Save</button>', '     <button type="reset" class="photo-tags-form-button">Cancel</button>', '</form>'].join('\n');

  Tagla.TAG_TEMPLATE = ['<div class="tagla-tag">', '    <i class="tagla-icon fs fs-tag"></i>', '    <span class="tagla-label">', '      {{label}}', '      <a href="javascript:void(0)" class="tagla-tag-link tagla-tag-edit-link">', '        <i class="fs fs-pencil"></i> Edit', '      </a>', '      <a href="javascript:void(0)" class="tagla-tag-link tagla-tag-delete-link">', '        <i class="fs fs-cross3"></i> Delete', '      </a>', '    </span>', '    <div class="tagla-dialog">', '        {{#image}}', '        <div class="tagla-dialog-image">', '          <img src="{{image}}">', '        </div>', '        {{/image}}', '        <div class="tagla-dialog-text">', '          <h2 class="tagla-dialog-title">{{label}}</h2>', '          <div class="tagla-dialog-price">{{price}}</div>', '          <p class="tagla-dialog-description">{{description}}</p>', '          <a href="{{url}}" class="tagla-dialog-button st-btn st-btn-success st-btn-solid">', '            <i class="fs fs-cart"></i>', '            Buy Now', '          </a>', '        </div>', '    </div>', '</div>'].join('\n');

  Tagla.NEW_TAG_TEMPLATE = ['<div class="tagla-tag">', '    <i class="tagla-icon fs fs-tag"></i>', '    <span class="tagla-label">{{label}}</span>', '</div>'].join('\n');

  proto = {
    log: function(msg, type) {
      if (type == null) {
        type = 'info';
      }
      if (!this.debug || !window.console || !window.console[type]) {
        return;
      }
      return window.console[type]("[" + Tagla.NAME + "] " + msg);
    },
    formatFloat: function(num, pos) {
      var size;
      size = Math.pow(10, pos);
      return Math.round(num * size) / size;
    },
    appendTag: function(tag) {
      var $tag, offsetX, offsetY;
      this.log('appendTag() is executed');
      $tag = $(Mustache.render(this.tagTemplate, tag));
      this.wrapper.append($tag);
      offsetX = this.formatFloat($tag.outerWidth() / 2 / this.wrapper.width() * 100, 2);
      offsetY = this.formatFloat($tag.outerHeight() / 2 / this.wrapper.height() * 100, 2);
      return setTimeout(function() {
        return $tag.css({
          left: (tag.x - offsetX) + "%",
          top: (tag.y - offsetY) + "%"
        }, 500);
      });
    },
    updateImageSize: function() {
      var image;
      this.log('updateImageSize() is executed');
      image = this.image[0];
      this.currentWidth = image.width;
      this.currentHeight = image.height;
      this.widthRatio = this.currentWidth / this.naturalWidth;
      return this.heightRatio = this.currentHeight / this.naturalHeight;
    },
    handleImageError: function(e) {
      this.log('handleImageError() is executed');
      this.imageLoaded = false;
      return this.destroy();
    },
    handleImageLoad: function(e) {
      this.log('handleImageLoad() is executed');
      this.imageLoaded = true;
      this.naturalWidth = this.image[0].width;
      this.naturalHeight = this.image[0].height;
      this.updateImageSize();
      return this.render();
    },
    handleTagDelete: function(e) {
      var $tag, instance;
      this.log('handleTagDelete() is executed');
      e.preventDefault();
      $tag = $(e.currentTarget).parents('.tagla-tag');
      $tag.remove();
      instance = $tag.data('tagla-instance');
      if (instance) {
        return instance.destroy();
      }
    },
    handleWindowResize: function(e) {
      var image;
      this.log('handleImageResize() is executed');
      image = this.image[0];
      if (image.width === this.currentWidth && image.height === this.currentHeight) {
        return;
      }
      return this.updateImageSize();
    },
    edit: function() {
      if (this.editor === true) {
        return;
      }
      this.log('edit() is executed');
      this.wrapper.addClass('tagla-editing');
      $('.tagla-tag').each(function() {
        var instance;
        instance = $(this).data('tagla-instance');
        if (instance) {
          return instance.enable();
        } else {
          instance = new Draggabilly(this, {
            containment: '.tagla'
          });
          return $(this).data('tagla-instance', instance);
        }
      });
      return this.editor = true;
    },
    unedit: function() {
      if (this.edit === false) {
        return;
      }
      this.log('unedit() is executed');
      this.wrapper.find('.tagla-tag').each(function() {
        var instance;
        instance = $(this).data('tagla-instance');
        return instance.disable();
      });
      this.wrapper.removeClass('tagla-editing');
      return this.editor = false;
    },
    addTag: function() {
      var $tag, instance, offsetX, offsetY, tag;
      if (!this.editor) {
        return;
      }
      this.log('addTag() is executed');
      $tag = $(Mustache.render(Tagla.NEW_TAG_TEMPLATE, tag));
      this.wrapper.append($tag);
      tag = {
        x: 50,
        y: 50
      };
      offsetX = this.formatFloat($tag.outerWidth() / 2 / this.wrapper.width() * 100, 2);
      offsetY = this.formatFloat($tag.outerHeight() / 2 / this.wrapper.height() * 100, 2);
      $tag.css({
        left: (tag.x - offsetX) + "%",
        top: (tag.y - offsetY) + "%"
      });
      instance = new Draggabilly($tag[0], {
        containment: '.tagla'
      });
      return $(this).data('tagla-instance', instance);
    },
    deleteTag: function(e) {},
    init: function(options) {
      var _ref;
      this.data = options.data || [];
      this.editor = (_ref = options.editor === true) != null ? _ref : {
        on: false
      };
      this.form = options.form ? $(options.form) : Tagla.FORM_TEMPLATE;
      this.tagTemplate = options.tagTemplate ? $(options.tagTemplate).html() : Tagla.TAG_TEMPLATE;
      this.debug = true;
      this.image = this.wrapper.find('img');
      this.imageLoaded = this.image[0].complete;
      this.currentWidth = this.image[0].width;
      return this.currentHeight = this.image[0].height;
    },
    bind: function() {
      this.log('bind() is executed');
      this.wrapper.on('mouseenter', $.proxy(this.handleMouseEnter, this));
      this.wrapper.on('mouseenter', $.proxy(this.handleMouseEnter, this));
      this.wrapper.on('click', '.tagla-tag-delete-link', $.proxy(this.handleTagDelete, this));
      return $(window).on('resize', $.proxy(this.handleWindowResize, this));
    },
    render: function() {
      var img, tag, _i, _len, _ref;
      if (!this.imageLoaded) {
        img = new Image();
        img.src = this.image.attr('src');
        $(img).one('load', $.proxy(this.handleImageLoad, this)).one('error', $.proxy(this.handleImageError, this));
        return;
      }
      this.log('render() is executed');
      _ref = this.data;
      for (_i = 0, _len = _ref.length; _i < _len; _i++) {
        tag = _ref[_i];
        this.appendTag(tag);
      }
      return this.wrapper.addClass('tagla');
    },
    destroy: function() {
      return this.log('destroy() is executed');
    }
  };

  $.extend(Tagla.prototype, proto);

  window.Tagla = Tagla;

}).call(this);

//# sourceMappingURL=data:application/json;base64,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QkFBQTtBQUFBLFFBQUEsSUFBQyxDQUFBLFNBQUQsQ0FBVyxHQUFYLENBQUEsQ0FBQTtBQUFBLE9BVEE7YUFVQSxJQUFDLENBQUEsT0FBTyxDQUFDLFFBQVQsQ0FBbUIsT0FBbkIsRUFaTTtJQUFBLENBN0hSO0FBQUEsSUE0SUEsT0FBQSxFQUFTLFNBQUEsR0FBQTthQUNQLElBQUMsQ0FBQSxHQUFELENBQU0sdUJBQU4sRUFETztJQUFBLENBNUlUO0dBaEVGLENBQUE7O0FBQUEsRUErTUEsQ0FBQyxDQUFDLE1BQUYsQ0FBUyxLQUFLLENBQUEsU0FBZCxFQUFrQixLQUFsQixDQS9NQSxDQUFBOztBQUFBLEVBZ05BLE1BQU0sQ0FBQyxLQUFQLEdBQWUsS0FoTmYsQ0FBQTtBQUFBIiwiZmlsZSI6InRhZ2xhLmpzIiwic291cmNlUm9vdCI6Ii9zb3VyY2UvIiwic291cmNlc0NvbnRlbnQiOlsiXG5jbGFzcyBUYWdsYVxuICBjb25zdHJ1Y3RvcjogKCR3cmFwcGVyLCBvcHRpb25zID0ge30pIC0+XG4gICAgQHdyYXBwZXIgPSAkKCR3cmFwcGVyKVxuICAgIEBpbml0KG9wdGlvbnMpXG4gICAgQGJpbmQoKVxuXG5UYWdsYS5OQU1FID0gJ1RhZ2xhJ1xuVGFnbGEuUFJFRklYID0gJ3RhZ2xhLSdcblRhZ2xhLkZPUk1fVEVNUExBVEUgPSBbXG4gICc8Zm9ybSBjbGFzcz1cInBob3RvLXRhZ3MtZm9ybSBwaG90by10YWdzLWZvcm0taGlkZVwiPidcbiAgJyAgICAgPGlucHV0IHR5cGU9XCJoaWRkZW5cIiBuYW1lPVwieFwiPidcbiAgJyAgICAgPGlucHV0IHR5cGU9XCJoaWRkZW5cIiBuYW1lPVwieVwiPidcbiAgJyAgICAgPGxhYmVsIGNsYXNzPVwicGhvdG8tdGFncy1mb3JtLWxhYmVsXCI+J1xuICAnICAgICAgICAgPHNlbGVjdCBkYXRhLXBsYWNlaG9sZGVyPVwiQ2hvb3NlIHRhZ3MuLi5cIiB0eXBlPVwidGV4dFwiIG5hbWU9XCJsYWJlbFwiIGNsYXNzPVwidGFnbGEtZm9ybS1pbnB1dCBjaG9zZW4tc2VsZWN0XCI+J1xuICAnICAgICAgICAgICAgIDxvcHRpb24+RnJhbmtpZSBJc3N1ZSAjNjwvb3B0aW9uPidcbiAgJyAgICAgICAgICAgICA8b3B0aW9uPkZyYW5raWUgV2FsbCBDYWxlbmRhciAyMDE1PC9vcHRpb24+J1xuICAnICAgICAgICAgICAgIDxvcHRpb24+RnJhbmtpZSBBNSBEYWlseSBQbGFubmVyPC9vcHRpb24+J1xuICAnICAgICAgICAgPC9zZWxlY3Q+J1xuICAnICAgICA8L2xhYmVsPidcbiAgJyAgICAgPGJ1dHRvbiB0eXBlPVwic3VibWl0XCIgY2xhc3M9XCJwaG90by10YWdzLWZvcm0tYnV0dG9uXCI+U2F2ZTwvYnV0dG9uPidcbiAgJyAgICAgPGJ1dHRvbiB0eXBlPVwicmVzZXRcIiBjbGFzcz1cInBob3RvLXRhZ3MtZm9ybS1idXR0b25cIj5DYW5jZWw8L2J1dHRvbj4nXG4gICc8L2Zvcm0+J1xuXS5qb2luKCdcXG4nKVxuVGFnbGEuVEFHX1RFTVBMQVRFID0gW1xuICAnPGRpdiBjbGFzcz1cInRhZ2xhLXRhZ1wiPidcbiAgJyAgICA8aSBjbGFzcz1cInRhZ2xhLWljb24gZnMgZnMtdGFnXCI+PC9pPidcbiAgJyAgICA8c3BhbiBjbGFzcz1cInRhZ2xhLWxhYmVsXCI+J1xuICAnICAgICAge3tsYWJlbH19J1xuICAnICAgICAgPGEgaHJlZj1cImphdmFzY3JpcHQ6dm9pZCgwKVwiIGNsYXNzPVwidGFnbGEtdGFnLWxpbmsgdGFnbGEtdGFnLWVkaXQtbGlua1wiPidcbiAgJyAgICAgICAgPGkgY2xhc3M9XCJmcyBmcy1wZW5jaWxcIj48L2k+IEVkaXQnXG4gICcgICAgICA8L2E+J1xuICAnICAgICAgPGEgaHJlZj1cImphdmFzY3JpcHQ6dm9pZCgwKVwiIGNsYXNzPVwidGFnbGEtdGFnLWxpbmsgdGFnbGEtdGFnLWRlbGV0ZS1saW5rXCI+J1xuICAnICAgICAgICA8aSBjbGFzcz1cImZzIGZzLWNyb3NzM1wiPjwvaT4gRGVsZXRlJ1xuICAnICAgICAgPC9hPidcbiAgJyAgICA8L3NwYW4+J1xuICAnICAgIDxkaXYgY2xhc3M9XCJ0YWdsYS1kaWFsb2dcIj4nXG4gICcgICAgICAgIHt7I2ltYWdlfX0nXG4gICcgICAgICAgIDxkaXYgY2xhc3M9XCJ0YWdsYS1kaWFsb2ctaW1hZ2VcIj4nXG4gICcgICAgICAgICAgPGltZyBzcmM9XCJ7e2ltYWdlfX1cIj4nXG4gICcgICAgICAgIDwvZGl2PidcbiAgJyAgICAgICAge3svaW1hZ2V9fSdcbiAgJyAgICAgICAgPGRpdiBjbGFzcz1cInRhZ2xhLWRpYWxvZy10ZXh0XCI+J1xuICAnICAgICAgICAgIDxoMiBjbGFzcz1cInRhZ2xhLWRpYWxvZy10aXRsZVwiPnt7bGFiZWx9fTwvaDI+J1xuICAnICAgICAgICAgIDxkaXYgY2xhc3M9XCJ0YWdsYS1kaWFsb2ctcHJpY2VcIj57e3ByaWNlfX08L2Rpdj4nXG4gICcgICAgICAgICAgPHAgY2xhc3M9XCJ0YWdsYS1kaWFsb2ctZGVzY3JpcHRpb25cIj57e2Rlc2NyaXB0aW9ufX08L3A+J1xuICAnICAgICAgICAgIDxhIGhyZWY9XCJ7e3VybH19XCIgY2xhc3M9XCJ0YWdsYS1kaWFsb2ctYnV0dG9uIHN0LWJ0biBzdC1idG4tc3VjY2VzcyBzdC1idG4tc29saWRcIj4nXG4gICcgICAgICAgICAgICA8aSBjbGFzcz1cImZzIGZzLWNhcnRcIj48L2k+J1xuICAnICAgICAgICAgICAgQnV5IE5vdydcbiAgJyAgICAgICAgICA8L2E+J1xuICAnICAgICAgICA8L2Rpdj4nXG4gICcgICAgPC9kaXY+J1xuICAnPC9kaXY+J1xuXS5qb2luKCdcXG4nKVxuVGFnbGEuTkVXX1RBR19URU1QTEFURSA9IFtcbiAgJzxkaXYgY2xhc3M9XCJ0YWdsYS10YWdcIj4nXG4gICcgICAgPGkgY2xhc3M9XCJ0YWdsYS1pY29uIGZzIGZzLXRhZ1wiPjwvaT4nXG4gICcgICAgPHNwYW4gY2xhc3M9XCJ0YWdsYS1sYWJlbFwiPnt7bGFiZWx9fTwvc3Bhbj4nXG4gICc8L2Rpdj4nXG5dLmpvaW4oJ1xcbicpXG5cbnByb3RvID1cbiAgIyMjIyMjIyMjIyMjIyNcbiAgIyBVdGlsaXRpZXNcbiAgIyMjIyMjIyMjIyMjIyNcbiAgbG9nOiAobXNnLCB0eXBlID0gJ2luZm8nKSAtPlxuICAgIHJldHVybiBpZiAhQGRlYnVnIG9yICF3aW5kb3cuY29uc29sZSBvciAhd2luZG93LmNvbnNvbGVbdHlwZV1cbiAgICB3aW5kb3cuY29uc29sZVt0eXBlXSBcIlsje1RhZ2xhLk5BTUV9XSAje21zZ31cIlxuXG4gIGZvcm1hdEZsb2F0OiAobnVtLCBwb3MpIC0+XG4gICAgc2l6ZSA9IE1hdGgucG93KDEwLCBwb3MpXG4gICAgTWF0aC5yb3VuZChudW0gKiBzaXplKSAvIHNpemVcblxuICBhcHBlbmRUYWc6ICh0YWcpIC0+XG4gICAgQGxvZyAnYXBwZW5kVGFnKCkgaXMgZXhlY3V0ZWQnXG4gICAgJHRhZyA9ICQoTXVzdGFjaGUucmVuZGVyKEB0YWdUZW1wbGF0ZSwgdGFnKSlcbiAgICBAd3JhcHBlci5hcHBlbmQoJHRhZylcblxuICAgIG9mZnNldFggPSBAZm9ybWF0RmxvYXQoJHRhZy5vdXRlcldpZHRoKCkgLyAyIC8gQHdyYXBwZXIud2lkdGgoKSAqIDEwMCwgMilcbiAgICBvZmZzZXRZID0gQGZvcm1hdEZsb2F0KCR0YWcub3V0ZXJIZWlnaHQoKSAvIDIgLyBAd3JhcHBlci5oZWlnaHQoKSAqIDEwMCwgMilcbiAgICBzZXRUaW1lb3V0IC0+XG4gICAgICAkdGFnLmNzc1xuICAgICAgICBsZWZ0OiBcIiN7dGFnLnggLSBvZmZzZXRYfSVcIlxuICAgICAgICB0b3A6IFwiI3t0YWcueSAtIG9mZnNldFl9JVwiXG4gICAgICAsIDUwMFxuXG4gIHVwZGF0ZUltYWdlU2l6ZTogLT5cbiAgICBAbG9nICd1cGRhdGVJbWFnZVNpemUoKSBpcyBleGVjdXRlZCdcbiAgICBpbWFnZSA9IEBpbWFnZVswXVxuICAgIEBjdXJyZW50V2lkdGggPSBpbWFnZS53aWR0aFxuICAgIEBjdXJyZW50SGVpZ2h0ID0gaW1hZ2UuaGVpZ2h0XG4gICAgQHdpZHRoUmF0aW8gPSBAY3VycmVudFdpZHRoIC8gQG5hdHVyYWxXaWR0aFxuICAgIEBoZWlnaHRSYXRpbyA9IEBjdXJyZW50SGVpZ2h0IC8gQG5hdHVyYWxIZWlnaHRcblxuICAjIyMjIyMjIyMjIyMjIyMjIyMjI1xuICAjIEV2ZW50IEhhbmRsZXJzXG4gICMjIyMjIyMjIyMjIyMjIyMjIyMjXG4gIGhhbmRsZUltYWdlRXJyb3I6IChlKSAtPlxuICAgIEBsb2cgJ2hhbmRsZUltYWdlRXJyb3IoKSBpcyBleGVjdXRlZCdcbiAgICBAaW1hZ2VMb2FkZWQgPSBmYWxzZVxuICAgIEBkZXN0cm95KClcblxuICBoYW5kbGVJbWFnZUxvYWQ6IChlKSAtPlxuICAgIEBsb2cgJ2hhbmRsZUltYWdlTG9hZCgpIGlzIGV4ZWN1dGVkJ1xuICAgIEBpbWFnZUxvYWRlZCA9IHRydWVcbiAgICBAbmF0dXJhbFdpZHRoID0gQGltYWdlWzBdLndpZHRoXG4gICAgQG5hdHVyYWxIZWlnaHQgPSBAaW1hZ2VbMF0uaGVpZ2h0XG4gICAgQHVwZGF0ZUltYWdlU2l6ZSgpXG4gICAgQHJlbmRlcigpXG5cbiAgaGFuZGxlVGFnRGVsZXRlOiAoZSkgLT5cbiAgICBAbG9nICdoYW5kbGVUYWdEZWxldGUoKSBpcyBleGVjdXRlZCdcbiAgICBlLnByZXZlbnREZWZhdWx0KClcbiAgICAkdGFnID0gJChlLmN1cnJlbnRUYXJnZXQpLnBhcmVudHMoJy50YWdsYS10YWcnKVxuICAgICR0YWcucmVtb3ZlKClcbiAgICBpbnN0YW5jZSA9ICR0YWcuZGF0YSgndGFnbGEtaW5zdGFuY2UnKVxuICAgIGluc3RhbmNlLmRlc3Ryb3koKSBpZiAoaW5zdGFuY2UpXG5cbiAgaGFuZGxlV2luZG93UmVzaXplOiAoZSkgLT5cbiAgICBAbG9nICdoYW5kbGVJbWFnZVJlc2l6ZSgpIGlzIGV4ZWN1dGVkJ1xuICAgIGltYWdlID0gQGltYWdlWzBdXG4gICAgcmV0dXJuIGlmIGltYWdlLndpZHRoIGlzIEBjdXJyZW50V2lkdGggYW5kIGltYWdlLmhlaWdodCBpcyBAY3VycmVudEhlaWdodFxuICAgIEB1cGRhdGVJbWFnZVNpemUoKVxuXG4gICMjIyMjIyMjIyMjIyMjIyMjIyMjXG4gICMgUHVibGljIE1ldGhvZHNcbiAgIyMjIyMjIyMjIyMjIyMjIyMjIyNcbiAgZWRpdDogLT5cbiAgICByZXR1cm4gaWYgQGVkaXRvciBpcyBvblxuICAgIEBsb2cgJ2VkaXQoKSBpcyBleGVjdXRlZCdcbiAgICBAd3JhcHBlci5hZGRDbGFzcygndGFnbGEtZWRpdGluZycpXG4gICAgJCgnLnRhZ2xhLXRhZycpLmVhY2ggLT5cbiAgICAgIGluc3RhbmNlID0gJChAKS5kYXRhKCd0YWdsYS1pbnN0YW5jZScpXG4gICAgICBpZiBpbnN0YW5jZVxuICAgICAgICBpbnN0YW5jZS5lbmFibGUoKVxuICAgICAgZWxzZVxuICAgICAgICBpbnN0YW5jZSA9IG5ldyBEcmFnZ2FiaWxseShALCB7Y29udGFpbm1lbnQ6ICcudGFnbGEnfSlcbiAgICAgICAgJChAKS5kYXRhKCd0YWdsYS1pbnN0YW5jZScsIGluc3RhbmNlKVxuXG4gICAgQGVkaXRvciA9IG9uXG5cbiAgdW5lZGl0OiAtPlxuICAgIHJldHVybiBpZiBAZWRpdCBpcyBvZmZcbiAgICBAbG9nICd1bmVkaXQoKSBpcyBleGVjdXRlZCdcbiAgICBAd3JhcHBlci5maW5kKCcudGFnbGEtdGFnJykuZWFjaCAtPlxuICAgICAgaW5zdGFuY2UgPSAkKEApLmRhdGEoJ3RhZ2xhLWluc3RhbmNlJylcbiAgICAgIGluc3RhbmNlLmRpc2FibGUoKVxuICAgIEB3cmFwcGVyLnJlbW92ZUNsYXNzKCd0YWdsYS1lZGl0aW5nJylcbiAgICBAZWRpdG9yID0gb2ZmXG5cbiAgYWRkVGFnOiAtPlxuICAgIHJldHVybiB1bmxlc3MgQGVkaXRvciAjIE9ubHkgZm9yIGVkaXRvciBtb2RlXG4gICAgQGxvZyAnYWRkVGFnKCkgaXMgZXhlY3V0ZWQnXG4gICAgJHRhZyA9ICQoTXVzdGFjaGUucmVuZGVyKFRhZ2xhLk5FV19UQUdfVEVNUExBVEUsIHRhZykpXG4gICAgQHdyYXBwZXIuYXBwZW5kKCR0YWcpXG4gICAgdGFnID0geDogNTAsIHk6IDUwXG4gICAgb2Zmc2V0WCA9IEBmb3JtYXRGbG9hdCgkdGFnLm91dGVyV2lkdGgoKSAvIDIgLyBAd3JhcHBlci53aWR0aCgpICogMTAwLCAyKVxuICAgIG9mZnNldFkgPSBAZm9ybWF0RmxvYXQoJHRhZy5vdXRlckhlaWdodCgpIC8gMiAvIEB3cmFwcGVyLmhlaWdodCgpICogMTAwLCAyKVxuICAgICR0YWcuY3NzXG4gICAgICBsZWZ0OiBcIiN7dGFnLnggLSBvZmZzZXRYfSVcIlxuICAgICAgdG9wOiBcIiN7dGFnLnkgLSBvZmZzZXRZfSVcIlxuICAgIGluc3RhbmNlID0gbmV3IERyYWdnYWJpbGx5KCR0YWdbMF0sIHtjb250YWlubWVudDogJy50YWdsYSd9KVxuICAgICQoQCkuZGF0YSgndGFnbGEtaW5zdGFuY2UnLCBpbnN0YW5jZSlcblxuICBkZWxldGVUYWc6IChlKSAtPlxuXG5cbiAgIyMjIyMjIyMjIyMjIyMjIyMjIyNcbiAgIyBMaWZlY3ljbGUgTWV0aG9kc1xuICAjIyMjIyMjIyMjIyMjIyMjIyMjI1xuICBpbml0OiAob3B0aW9ucykgLT5cbiAgICAjIENvbmZpZ3VyZSBPcHRpb25zXG4gICAgQGRhdGEgPSBvcHRpb25zLmRhdGEgfHwgW11cbiAgICBAZWRpdG9yID0gKG9wdGlvbnMuZWRpdG9yIGlzIG9uKSA/IG9uIDogZmFsc2VcbiAgICBAZm9ybSA9IGlmIG9wdGlvbnMuZm9ybSB0aGVuICQob3B0aW9ucy5mb3JtKSBlbHNlIFRhZ2xhLkZPUk1fVEVNUExBVEVcbiAgICBAdGFnVGVtcGxhdGUgPSBpZiBvcHRpb25zLnRhZ1RlbXBsYXRlIHRoZW4gJChvcHRpb25zLnRhZ1RlbXBsYXRlKS5odG1sKCkgZWxzZSBUYWdsYS5UQUdfVEVNUExBVEVcbiAgICAjIEF0dHJpYnV0ZXNcbiAgICBAZGVidWcgPSB0cnVlXG4gICAgQGltYWdlID0gQHdyYXBwZXIuZmluZCgnaW1nJylcbiAgICBAaW1hZ2VMb2FkZWQgPSBAaW1hZ2VbMF0uY29tcGxldGVcbiAgICBAY3VycmVudFdpZHRoID0gQGltYWdlWzBdLndpZHRoXG4gICAgQGN1cnJlbnRIZWlnaHQgPSBAaW1hZ2VbMF0uaGVpZ2h0XG5cbiAgYmluZDogLT5cbiAgICBAbG9nICdiaW5kKCkgaXMgZXhlY3V0ZWQnXG4gICAgQHdyYXBwZXIub24gJ21vdXNlZW50ZXInLCAkLnByb3h5KEBoYW5kbGVNb3VzZUVudGVyLCBAKVxuICAgIEB3cmFwcGVyLm9uICdtb3VzZWVudGVyJywgJC5wcm94eShAaGFuZGxlTW91c2VFbnRlciwgQClcbiAgICBAd3JhcHBlci5vbiAnY2xpY2snLCAnLnRhZ2xhLXRhZy1kZWxldGUtbGluaycsICQucHJveHkoQGhhbmRsZVRhZ0RlbGV0ZSwgQClcbiAgICAkKHdpbmRvdykub24gJ3Jlc2l6ZScsICQucHJveHkoQGhhbmRsZVdpbmRvd1Jlc2l6ZSwgQClcblxuICByZW5kZXI6IC0+XG4gICAgIyBEZWxheSB0byBnZXQgZGltZW5zaW9uIGZpcnN0XG4gICAgdW5sZXNzIEBpbWFnZUxvYWRlZFxuICAgICAgaW1nID0gbmV3IEltYWdlKClcbiAgICAgIGltZy5zcmMgPSBAaW1hZ2UuYXR0cignc3JjJylcbiAgICAgICQoaW1nKVxuICAgICAgICAub25lICdsb2FkJywgJC5wcm94eShAaGFuZGxlSW1hZ2VMb2FkLCBAKVxuICAgICAgICAub25lICdlcnJvcicsICQucHJveHkoQGhhbmRsZUltYWdlRXJyb3IsIEApXG4gICAgICByZXR1cm5cblxuICAgIEBsb2cgJ3JlbmRlcigpIGlzIGV4ZWN1dGVkJ1xuICAgIEBhcHBlbmRUYWcgdGFnIGZvciB0YWcgaW4gQGRhdGFcbiAgICBAd3JhcHBlci5hZGRDbGFzcyAndGFnbGEnXG5cblxuICBkZXN0cm95OiAtPlxuICAgIEBsb2cgJ2Rlc3Ryb3koKSBpcyBleGVjdXRlZCdcblxuJC5leHRlbmQoVGFnbGE6OiwgcHJvdG8pXG53aW5kb3cuVGFnbGEgPSBUYWdsYVxuIl19